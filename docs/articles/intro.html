<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using the Tesseract OCR engine in R • cpp11tesseract</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Using the Tesseract OCR engine in R">
<meta property="og:description" content="cpp11tesseract">
<meta property="og:image" content="/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cpp11tesseract</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">5.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/intro.html">Using the Tesseract OCR engine in R</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ropensci/tesseract/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="intro_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Using the Tesseract OCR engine in R</h1>
            
            <h4 data-toc-skip class="date">2024-09-23</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/tesseract/blob/HEAD/vignettes/intro.Rmd" class="external-link"><code>vignettes/intro.Rmd</code></a></small>
      <div class="hidden name"><code>intro.Rmd</code></div>

    </div>

    
    
<p>The tesseract package provides R bindings <a href="https://github.com/tesseract-ocr/tesseract" class="external-link">Tesseract</a>: a powerful optical character recognition (OCR) engine that supports over 100 languages. The engine is highly configurable in order to tune the detection algorithms and obtain the best possible results.</p>
<p>Keep in mind that OCR (pattern recognition in general) is a very difficult problem for computers. Results will rarely be perfect and the accuracy rapidly decreases with the quality of the input image. But if you can get your input images to reasonable quality, Tesseract can often help to extract most of the text from the image.</p>
<div class="section level2">
<h2 id="extract-text-from-images">Extract Text from Images<a class="anchor" aria-label="anchor" href="#extract-text-from-images"></a>
</h2>
<p>OCR is the process of finding and recognizing text inside images, for example from a screenshot, scanned paper. The image below has some example text:</p>
<div class="figure">
<img src="../reference/figures/testocr.png" alt=""><p class="caption">test</p>
</div>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/tesseract/" class="external-link">cpp11tesseract</a></span><span class="op">)</span></span>
<span><span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples"</span>, <span class="st">"testocr.png"</span>, package <span class="op">=</span> <span class="st">"cpp11tesseract"</span><span class="op">)</span></span>
<span><span class="va">eng</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tesseract.html">tesseract</a></span><span class="op">(</span><span class="st">"eng"</span><span class="op">)</span></span>
<span><span class="va">text</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ocr.html">ocr</a></span><span class="op">(</span><span class="va">file</span>, engine <span class="op">=</span> <span class="va">eng</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">text</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## This is a lot of 12 point text to test the</span></span>
<span><span class="co">## ocr code and see if it works on all types</span></span>
<span><span class="co">## of file format.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## The quick brown dog jumped over the</span></span>
<span><span class="co">## lazy fox. The quick brown dog jumped</span></span>
<span><span class="co">## over the lazy fox. The quick brown dog</span></span>
<span><span class="co">## jumped over the lazy fox. The quick</span></span>
<span><span class="co">## brown dog jumped over the lazy fox.</span></span></code></pre>
<p>Not bad! The <code><a href="../reference/ocr.html">ocr_data()</a></code> function returns all words in the image along with a bounding box and confidence rate.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ocr.html">ocr_data</a></span><span class="op">(</span><span class="va">file</span>, engine <span class="op">=</span> <span class="va">eng</span><span class="op">)</span></span>
<span><span class="va">results</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 60 × 4</span></span></span>
<span><span class="co">##    word  confidence bbox           stringsAsFactors</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>           </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> This        96.8 36,92,96,116   FALSE           </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> is          96.9 109,92,129,116 FALSE           </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> a           95.0 141,98,156,116 FALSE           </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> lot         95.0 169,92,201,116 FALSE           </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> of          96.4 212,92,240,116 FALSE           </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> 12          96.4 251,92,282,116 FALSE           </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> point       96.3 296,92,364,122 FALSE           </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> text        96.2 374,93,427,116 FALSE           </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> to          97.0 437,93,463,116 FALSE           </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> test        97.0 474,93,526,116 FALSE           </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 50 more rows</span></span></span></code></pre>
</div>
<div class="section level2">
<h2 id="language-data">Language Data<a class="anchor" aria-label="anchor" href="#language-data"></a>
</h2>
<p>The tesseract OCR engine uses language-specific training data in the recognize words. The OCR algorithms bias towards words and sentences that frequently appear together in a given language, just like the human brain does. Therefore the most accurate results will be obtained when using training data in the correct language.</p>
<p>Use <code><a href="../reference/tesseract.html">tesseract_info()</a></code> to list the languages that you currently have installed.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tesseract.html">tesseract_info</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $datapath</span></span>
<span><span class="co">## [1] "/usr/share/tesseract-ocr/5/tessdata/"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $available</span></span>
<span><span class="co">## [1] "chi_sim" "eng"    </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $version</span></span>
<span><span class="co">## [1] "5.4.1"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $configs</span></span>
<span><span class="co">##  [1] "alto"             "ambigs.train"     "api_config"       "bigram"          </span></span>
<span><span class="co">##  [5] "box.train"        "box.train.stderr" "digits"           "get.images"      </span></span>
<span><span class="co">##  [9] "hocr"             "inter"            "kannada"          "linebox"         </span></span>
<span><span class="co">## [13] "logfile"          "lstm.train"       "lstmbox"          "lstmdebug"       </span></span>
<span><span class="co">## [17] "makebox"          "page"             "pdf"              "quiet"           </span></span>
<span><span class="co">## [21] "rebox"            "strokewidth"      "tsv"              "txt"             </span></span>
<span><span class="co">## [25] "unlv"             "wordstrbox"</span></span></code></pre>
<p>By default the R package only includes English training data. Windows and Mac users can install additional training data using <code><a href="../reference/tessdata.html">tesseract_download()</a></code>. Let’s OCR a screenshot from Wikipedia in Simplified Chinese.</p>
<div class="figure">
<img src="../reference/figures/chinese.png" alt=""><p class="caption">chinese</p>
</div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Only need to do download once:</span></span>
<span><span class="fu"><a href="../reference/tessdata.html">tesseract_download</a></span><span class="op">(</span><span class="st">"chi_sim"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Now load the dictionary</span></span>
<span><span class="op">(</span><span class="va">simplified_chinese</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tesseract.html">tesseract</a></span><span class="op">(</span><span class="st">"chi_sim"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## &lt;pointer: 0x5b48ba3c7aa0&gt;</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples"</span>, <span class="st">"chinese.png"</span>, package <span class="op">=</span> <span class="st">"cpp11tesseract"</span><span class="op">)</span></span>
<span><span class="va">text</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ocr.html">ocr</a></span><span class="op">(</span><span class="va">file</span>, engine <span class="op">=</span> <span class="va">simplified_chinese</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">text</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 奥林匹克运动会 (希腊语: OAuhruakof AYwWvsc; 法语: Jeux olympiques; 英语:</span></span>
<span><span class="co">## Olympic Games) ，简称奥运会、奥运，是世界最高等级的国陈综合体育赛事，由国陈</span></span>
<span><span class="co">## 奥林匹克委员会主办，每4年学行一次。冬季欧技项目创立冬季奥林匹克运动会后，之前</span></span>
<span><span class="co">## 的奥林匹克运动会则是又称为 夏季奥林匹克运动会 以示区分。从1994年起，冬季奥</span></span>
<span><span class="co">## 运会和夏季奥运会分并，相隔2年交共举行。奥林匹克运动会最早起源於古希腊，是当时</span></span>
<span><span class="co">## 各城邦之间的公开较量，因为举办地在奥林匹亚而得名。信幸基督教的中马皇帝狄奥多西</span></span>
<span><span class="co">## 一世以奥林匹克运动会崇拜耶稣以外神只为由，禁止奥运将技，於是奥运在举办超过</span></span>
<span><span class="co">## 1,000年后於4世纪未停办，奥运这次停办持续了1,503年，直到19世纪示才由和后人发现</span></span>
<span><span class="co">## 遗距。之后，法国的顾和拜旦男吉皮子:德.古柏坦创立了有真正奥运精神的现代奥林匹克运</span></span>
<span><span class="co">## 动会，自1896年开始每4年举办一次，更确立了会期不超过18日的传统。现代奥运会只</span></span>
<span><span class="co">## 在两次世界大战期间合共中断过5次 (分别是191 6年夏季奥运会、1940年夏季奥运会</span></span>
<span><span class="co">## [、1940年冬季奥运会(1]、1944年夏季奥运会和1944年冬季奥运会) [广 1]]，以及在</span></span>
<span><span class="co">## 2020年因全球防疫延期过一次 (2020年夏季奥运会[2][广2]) 。</span></span></code></pre>
<p>Compare with the copy and paste from the Wikipedia.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">text2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readLines.html" class="external-link">readLines</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples"</span>, <span class="st">"chinese.txt"</span>, package <span class="op">=</span> <span class="st">"cpp11tesseract"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">text2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 奧林匹克運動會（希臘語：Ολυμπιακοί Αγώνες；法語：Jeux olympiques；英語：Olympic Games），簡稱奧運會、奧運，是世界最高等級的國際綜合體育賽事，由國際奧林匹克委員會主辦，每4年舉行一次。冬季競技項目創立冬季奧林匹克運動會後，之前的奧林匹克運動會則是又稱為「夏季奧林匹克運動會」以示區分。從1994年起，冬季奧運會和夏季奧運會分開，相隔2年交替舉行。奥林匹克運動會最早起源於古希腊，是當時各城邦之間的公開較量，因為舉辦地在奧林匹亚而得名。信奉基督教的羅馬皇帝狄奧多西一世以奧林匹克運動會崇拜耶穌以外神衹為由，禁止奧運競技，於是奧運在舉辦超過1,000年後於4世紀末停辦，奧運這次停辦持續了1,503年，直到19世纪末才由後人發現遺蹟。之後，法國的顾拜旦男爵皮耶·德·古柏坦創立了有真正奧運精神的現代奧林匹克運動會，自1896年開始每4年舉辦一次，更確立了會期不超過18日的傳統。現代奧運會只在兩次世界大戰期間合共中斷過5次（分別是1916年夏季奧運會、1940年夏季奧運會[1]、1940年冬季奧運會[1]、1944年夏季奧運會和1944年冬季奧運會）[註 1]，以及在2020年因全球防疫延期過一次（2020年夏季奧運會[2][註 2]）。</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="preprocessing-with-magick">Preprocessing with Magick<a class="anchor" aria-label="anchor" href="#preprocessing-with-magick"></a>
</h2>
<p>The accuracy of the OCR process depends on the quality of the input image. You can often improve results by properly scaling the image, removing noise and artifacts or cropping the area where the text exists. See <a href="https://tesseract-ocr.github.io/tessdoc/ImproveQuality" class="external-link">tesseract wiki: improve quality</a> for important tips to improve the quality of your input image.</p>
<p>The awesome <a href="https://cran.r-project.org/package=magick/vignettes/intro.html" class="external-link">magick</a> R package has many useful functions that can be use for enhancing the quality of the image. Some things to try:</p>
<ul>
<li>If your image is skewed, use <code><a href="https://docs.ropensci.org/magick/reference/transform.html" class="external-link">image_deskew()</a></code> and <code><a href="https://docs.ropensci.org/magick/reference/transform.html" class="external-link">image_rotate()</a></code> make the text horizontal.</li>
<li>
<code><a href="https://docs.ropensci.org/magick/reference/transform.html" class="external-link">image_trim()</a></code> crops out whitespace in the margins. Increase the <code>fuzz</code> parameter to make it work for noisy whitespace.</li>
<li>Use <code><a href="https://docs.ropensci.org/magick/reference/editing.html" class="external-link">image_convert()</a></code> to turn the image into greyscale, which can reduce artifacts and enhance actual text.</li>
<li>If your image is very large or small resizing with <code><a href="https://docs.ropensci.org/magick/reference/transform.html" class="external-link">image_resize()</a></code> can help tesseract determine text size.</li>
<li>Use <code><a href="https://docs.ropensci.org/magick/reference/color.html" class="external-link">image_modulate()</a></code> or <code><a href="https://docs.ropensci.org/magick/reference/color.html" class="external-link">image_contrast()</a></code> or <code><a href="https://docs.ropensci.org/magick/reference/color.html" class="external-link">image_contrast()</a></code> to tweak brightness / contrast if this is an issue.</li>
<li>Try <code><a href="https://docs.ropensci.org/magick/reference/effects.html" class="external-link">image_reducenoise()</a></code> for automated noise removal. Your mileage may vary.</li>
<li>With <code><a href="https://docs.ropensci.org/magick/reference/color.html" class="external-link">image_quantize()</a></code> you can reduce the number of colors in the image. This can sometimes help with increasing contrast and reducing artifacts.</li>
<li>True imaging ninjas can use <code><a href="https://docs.ropensci.org/magick/reference/morphology.html" class="external-link">image_convolve()</a></code> to use custom <a href="https://ropensci.org/technotes/2017/11/02/image-convolve/" class="external-link">convolution methods</a>.</li>
</ul>
<p>Below is an example OCR scan. The code converts it to black-and-white and resizes + crops the image before feeding it to tesseract to get more accurate OCR results.</p>
<div class="figure">
<img src="../reference/figures/bowers.jpg" alt=""><p class="caption">bowers</p>
</div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/magick/" class="external-link">magick</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Linking to ImageMagick 6.9.11.60</span></span>
<span><span class="co">## Enabled features: fontconfig, freetype, fftw, heic, lcms, pango, webp, x11</span></span>
<span><span class="co">## Disabled features: cairo, ghostscript, raw, rsvg</span></span></code></pre>
<pre><code><span><span class="co">## Using 8 threads</span></span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples"</span>, <span class="st">"bowers.jpg"</span>, package <span class="op">=</span> <span class="st">"cpp11tesseract"</span><span class="op">)</span></span>
<span><span class="va">input</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/magick/reference/editing.html" class="external-link">image_read</a></span><span class="op">(</span><span class="va">file</span><span class="op">)</span></span>
<span></span>
<span><span class="va">text</span> <span class="op">&lt;-</span> <span class="va">input</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/magick/reference/transform.html" class="external-link">image_resize</a></span><span class="op">(</span><span class="st">"2000x"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/magick/reference/editing.html" class="external-link">image_convert</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"Grayscale"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/magick/reference/transform.html" class="external-link">image_trim</a></span><span class="op">(</span>fuzz <span class="op">=</span> <span class="fl">40</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/magick/reference/editing.html" class="external-link">image_write</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"png"</span>, density <span class="op">=</span> <span class="st">"300x300"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/ocr.html">ocr</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">text</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## The Life and Work of</span></span>
<span><span class="co">## Fredson Bowers</span></span>
<span><span class="co">## by</span></span>
<span><span class="co">## G. THOMAS TANSELLE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## N EVERY FIELD OF ENDEAVOR THERE ARE A FEW FIGURES WHOSE ACCOM-</span></span>
<span><span class="co">## plishment and influence cause them to be the symbols of their age;</span></span>
<span><span class="co">## their careers and oeuvres become the touchstones by which the</span></span>
<span><span class="co">## field is measured and its history told. In the related pursuits of</span></span>
<span><span class="co">## analytical and descriptive bibliography, textual criticism, and scholarly</span></span>
<span><span class="co">## editing, Fredson Bowers was such a figure, dominating the four decades</span></span>
<span><span class="co">## after 1949, when his Principles of Bibliographical Description was pub-</span></span>
<span><span class="co">## lished. By 1973 the period was already being called “the age of Bowers”:</span></span>
<span><span class="co">## in that year Norman Sanders, writing the chapter on textual scholarship</span></span>
<span><span class="co">## for Stanley Wells’s Shakespeare: Select Bibliographies, gave this title to</span></span>
<span><span class="co">## a section of his essay. For most people, it would be achievement enough</span></span>
<span><span class="co">## to rise to such a position in a field as complex as Shakespearean textual</span></span>
<span><span class="co">## studies; but Bowers played an equally important role in other areas.</span></span>
<span><span class="co">## Editors of nineteenth-century American authors, for example, would</span></span>
<span><span class="co">## also have to call the recent past “the age of Bowers,” as would the writers</span></span>
<span><span class="co">## of descriptive bibliographies of authors and presses. His ubiquity in</span></span>
<span><span class="co">## the broad field of bibliographical and textual study, his seemingly com-</span></span>
<span><span class="co">## plete possession of it, distinguished him from his illustrious predeces-</span></span>
<span><span class="co">## sors and made him the personification of bibliographical scholarship in</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## his time.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## When in 1969 Bowers was awarded the Gold Medal of the Biblio-</span></span>
<span><span class="co">## graphical Society in London, John Carter’s citation referred to the</span></span>
<span><span class="co">## Principles as “majestic,” called Bowers’s current projects “formidable,”</span></span>
<span><span class="co">## said that he had “imposed critical discipline” on the texts of several</span></span>
<span><span class="co">## authors, described Studies in Bibliography as a “great and continuing</span></span>
<span><span class="co">## achievement,” and included among his characteristics “uncompromising</span></span>
<span><span class="co">## seriousness of purpose” and “professional intensity.” Bowers was not</span></span>
<span><span class="co">## unaccustomed to such encomia, but he had also experienced his share of</span></span>
<span><span class="co">## attacks: his scholarly positions were not universally popular, and he</span></span>
<span><span class="co">## expressed them with an ageressiveness that almost seemed calculated to</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="read-from-pdf-files">Read from PDF files<a class="anchor" aria-label="anchor" href="#read-from-pdf-files"></a>
</h2>
<p>If your images are stored in PDF files they first need to be converted to a proper image format. We can do this in R using the <code>pdf_convert</code> function from the pdftools package. Use a high DPI to keep quality of the image.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples"</span>, <span class="st">"ocrscan.pdf"</span>, package <span class="op">=</span> <span class="st">"cpp11tesseract"</span><span class="op">)</span></span>
<span><span class="va">pngfile</span> <span class="op">&lt;-</span> <span class="fu">pdftools</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/pdftools/reference/pdf_render_page.html" class="external-link">pdf_convert</a></span><span class="op">(</span><span class="va">file</span>, dpi <span class="op">=</span> <span class="fl">600</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Converting page 1 to ocrscan_1.png... done!</span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">text</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ocr.html">ocr</a></span><span class="op">(</span><span class="va">pngfile</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">text</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## | SAPORS LANE - BOOLE - DORSET - BH 25 8 ER</span></span>
<span><span class="co">## TELEPHONE BOOLE (945 13) 51617 - TELEX 123456</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Our Ref. 350/PJC/EAC 18th January, 1972.</span></span>
<span><span class="co">## Dr. P.N. Cundall,</span></span>
<span><span class="co">## Mining Surveys Ltd.,</span></span>
<span><span class="co">## Holroyd Road,</span></span>
<span><span class="co">## Reading,</span></span>
<span><span class="co">## Berks.</span></span>
<span><span class="co">## Dear Pete,</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Permit me to introduce you to the facility of facsimile</span></span>
<span><span class="co">## transmission.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## In facsimile a photocell is caused to perform a raster scan over</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## the subject copy. The variations of print density on the document</span></span>
<span><span class="co">## cause the photocell to generate an analogous electrical video signal.</span></span>
<span><span class="co">## This signal is used to modulate a carrier, which is transmitted to a</span></span>
<span><span class="co">## remote destination over a radio or cable communications link.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## At the remote terminal, demodulation reconstructs the video</span></span>
<span><span class="co">## signal, which is used to modulate the density of print produced by a</span></span>
<span><span class="co">## printing device. This device is scanning in a raster scan synchronised</span></span>
<span><span class="co">## with that at the transmitting terminal. As a result, a facsimile</span></span>
<span><span class="co">## copy of the subject document is produced.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Probably you have uses for this facility in your organisation.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Yours sincerely,</span></span>
<span><span class="co">## P.J. CROSS</span></span>
<span><span class="co">## Group Leader - Facsimile Research</span></span>
<span><span class="co">## Registered in England: No. 2038</span></span>
<span><span class="co">## No. 1 Registered Office: GO Vicara Lane, Ilford. Essex.</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="tesseract-control-parameters">Tesseract Control Parameters<a class="anchor" aria-label="anchor" href="#tesseract-control-parameters"></a>
</h2>
<p>Tesseract supports hundreds of “control parameters” which alter the OCR engine. Use <code><a href="../reference/tesseract.html">tesseract_params()</a></code> to list all parameters with their default value and a brief description. It also has a handy <code>filter</code> argument to quickly find parameters that match a particular string.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># List all parameters with *colour* in name or description</span></span>
<span><span class="fu"><a href="../reference/tesseract.html">tesseract_params</a></span><span class="op">(</span><span class="st">"colour"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 2 × 3</span></span></span>
<span><span class="co">##   param                      default desc                    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> editor_image_word_bb_color 7       Word bounding box colour</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> editor_image_blob_bb_color 4       Blob bounding box colour</span></span></code></pre>
<p>Do note that some of the control parameters have changed between Tesseract engine 3 and 4.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tesseract.html">tesseract_info</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="st">'version'</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## $version</span></span>
<span><span class="co">## [1] "5.4.1"</span></span></code></pre>
<div class="section level3">
<h3 id="whitelist-blacklist-characters">Whitelist / Blacklist characters<a class="anchor" aria-label="anchor" href="#whitelist-blacklist-characters"></a>
</h3>
<p>One powerful parameter is <code>tessedit_char_whitelist</code> which restricts the output to a limited set of characters. This may be useful for reading for example numbers such as a bank account, zip code, or gas meter.</p>
<p>The whitelist parameter works for all versions of Tesseract engine 3 and also engine versions 4.1 and higher, but unfortunately it did not work in Tesseract 4.0.</p>
<div class="figure">
<img src="../reference/figures/receipt.png" alt=""><p class="caption">receipt</p>
</div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples"</span>, <span class="st">"receipt.png"</span>, package <span class="op">=</span> <span class="st">"cpp11tesseract"</span><span class="op">)</span></span>
<span><span class="va">numbers</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tesseract.html">tesseract</a></span><span class="op">(</span>options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>tessedit_char_whitelist <span class="op">=</span> <span class="st">"$.0123456789"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="../reference/ocr.html">ocr</a></span><span class="op">(</span><span class="va">file</span>, engine <span class="op">=</span> <span class="va">numbers</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $90.52</span></span>
<span><span class="co">## $81.52</span></span>
<span><span class="co">## $9.00</span></span>
<span><span class="co">## $90.52</span></span></code></pre>
<p>To test if this actually works, look what happens if we remove the <code>$</code> from <code>tessedit_char_whitelist</code>:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Do not allow any dollar sign</span></span>
<span><span class="va">numbers2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tesseract.html">tesseract</a></span><span class="op">(</span>options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>tessedit_char_whitelist <span class="op">=</span> <span class="st">".0123456789"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="../reference/ocr.html">ocr</a></span><span class="op">(</span><span class="va">file</span>, engine <span class="op">=</span> <span class="va">numbers2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 90.52</span></span>
<span><span class="co">## 81.52</span></span>
<span><span class="co">## 9.00</span></span>
<span><span class="co">## 90.52</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="best-versus-fast-models">Best versus Fast models<a class="anchor" aria-label="anchor" href="#best-versus-fast-models"></a>
</h2>
<p>In order to improve the OCR results, Tesseract has two variants of models that can be used. The <code><a href="../reference/tessdata.html">tesseract_download()</a></code> can download the ‘best’ (but slower) model, which increases the accuracy. The ‘fast’ (but less accurate) model is the default.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples"</span>, <span class="st">"chinese.png"</span>, package <span class="op">=</span> <span class="st">"cpp11tesseract"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># download the best model (vertical script download is to avoid a warning)</span></span>
<span><span class="va">dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/tessdata.html">tesseract_download</a></span><span class="op">(</span><span class="st">"chi_sim_vert"</span>, datapath <span class="op">=</span> <span class="va">dir</span>, model <span class="op">=</span> <span class="st">"best"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/tessdata.html">tesseract_download</a></span><span class="op">(</span><span class="st">"chi_sim"</span>, datapath <span class="op">=</span> <span class="va">dir</span>, model <span class="op">=</span> <span class="st">"best"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># compare the results: fast (text1) vs best (text2)</span></span>
<span><span class="va">text1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ocr.html">ocr</a></span><span class="op">(</span><span class="va">file</span>, engine <span class="op">=</span> <span class="fu"><a href="../reference/tesseract.html">tesseract</a></span><span class="op">(</span><span class="st">"chi_sim"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">text2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ocr.html">ocr</a></span><span class="op">(</span><span class="va">file</span>, engine <span class="op">=</span> <span class="fu"><a href="../reference/tesseract.html">tesseract</a></span><span class="op">(</span><span class="st">"chi_sim"</span>, datapath <span class="op">=</span> <span class="va">dir</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">text1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">text2</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="contributed-models">Contributed models<a class="anchor" aria-label="anchor" href="#contributed-models"></a>
</h2>
<p>The <code>tesseract_contributed_download()</code> function can download contributed models. For example, the <code>grc_hist</code> model is useful for Polytonic Greek. Here is an example from Sophocles’ Ajax (source: <a href="https://github.com/AjaxMultiCommentary" class="external-link">Ajax Multi-Commentary</a>)</p>
<div class="figure">
<img src="../reference/figures/polytonicgreek.png" alt=""><p class="caption">polytonicgreek</p>
</div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples"</span>, <span class="st">"polytonicgreek.png"</span>, package <span class="op">=</span> <span class="st">"cpp11tesseract"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># download the best models</span></span>
<span><span class="va">dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/tessdata.html">tesseract_download</a></span><span class="op">(</span><span class="st">"grc"</span>, datapath <span class="op">=</span> <span class="va">dir</span>, model <span class="op">=</span> <span class="st">"best"</span><span class="op">)</span></span>
<span><span class="fu">tesseract_contributed_download</span><span class="op">(</span><span class="st">"grc_hist"</span>, datapath <span class="op">=</span> <span class="va">dir</span>, model <span class="op">=</span> <span class="st">"best"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># compare the results: grc (text1) vs grc_hist (text2)</span></span>
<span><span class="va">text1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ocr.html">ocr</a></span><span class="op">(</span><span class="va">file</span>, engine <span class="op">=</span> <span class="fu"><a href="../reference/tesseract.html">tesseract</a></span><span class="op">(</span><span class="st">"grc"</span>, datapath <span class="op">=</span> <span class="va">dir</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">text2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ocr.html">ocr</a></span><span class="op">(</span><span class="va">file</span>, engine <span class="op">=</span> <span class="fu"><a href="../reference/tesseract.html">tesseract</a></span><span class="op">(</span><span class="st">"grc_hist"</span>, datapath <span class="op">=</span> <span class="va">dir</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">text1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">text2</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="comparison-with-amazon-textract">Comparison with Amazon Textract<a class="anchor" aria-label="anchor" href="#comparison-with-amazon-textract"></a>
</h2>
<p><em>Note: Amazon and Textract are trademarks of Amazon.com, Inc.</em></p>
<p>Textract <a href="https://aws.amazon.com/blogs/opensource/using-r-with-amazon-web-services-for-document-analysis/" class="external-link">documentation</a> uses page three of the <a href="https://www.philadelphiafed.org/-/media/frbp/assets/surveys-and-data/greenbook-data/greensheets/greensheets-1966.zip?la=en&amp;hash=8B8ABA92C3F0B2939328D47B6230F3A3" class="external-link">January 1966 report</a> from Philadelphia Fed’s <a href="https://www.philadelphiafed.org/surveys-and-data/real-time-data-research/philadelphia-data-set" class="external-link">Tealbook</a> (formerly Greenbook).</p>
<div class="figure">
<img src="../reference/figures/tealbook.png" alt=""><p class="caption">tealbook</p>
</div>
<p>Here is the first element of the list returned by Textract:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># List of 13</span></span>
<span><span class="co"># $ BlockType      : chr "TABLE"</span></span>
<span><span class="co"># $ Confidence     : num 100</span></span>
<span><span class="co"># $ Text           : chr(0)</span></span>
<span><span class="co"># $ RowIndex       : int(0)</span></span>
<span><span class="co"># $ ColumnIndex    : int(0)</span></span>
<span><span class="co"># $ RowSpan        : int(0)</span></span>
<span><span class="co"># $ ColumnSpan     : int(0)</span></span>
<span><span class="co"># $ Geometry       :List of 2</span></span>
<span><span class="co"># .. &lt;not shown&gt;</span></span>
<span><span class="co"># $ Id             : chr "c6841638-d3e0-414b-af12-b94ed34aac8a"</span></span>
<span><span class="co"># $ Relationships  :List of 1</span></span>
<span><span class="co"># ..$ :List of 2</span></span>
<span><span class="co"># .. ..$ Type: chr "CHILD"</span></span>
<span><span class="co"># .. ..$ Ids : chr [1:256] "e1866e80-0ef0-4bdd-a6fd-9508bb833c03" ...</span></span>
<span><span class="co"># $ EntityTypes    : list()</span></span>
<span><span class="co"># $ SelectionStatus: chr(0)</span></span>
<span><span class="co"># $ Page           : int 3</span></span></code></pre></div>
<p>Here is Tesseract’s output:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples"</span>, <span class="st">"tealbook.png"</span>, package <span class="op">=</span> <span class="st">"cpp11tesseract"</span><span class="op">)</span></span>
<span><span class="va">text</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ocr.html">ocr</a></span><span class="op">(</span><span class="va">file</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">text</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Nemes mm a a ee en e-em n an ae ee</span></span>
<span><span class="co">## Year SSC—~SSESSC~*«C</span></span>
<span><span class="co">## 1965 IV I</span></span>
<span><span class="co">## Esti- Esti- Pro-</span></span>
<span><span class="co">## 1964 __mated yi/ rr/ rrr! mated _ jected</span></span>
<span><span class="co">## Gross National Product 628.7 675.7 657.6 668.8 681.5 695.0 707.0</span></span>
<span><span class="co">## Personal consumption expenditures 398.9 428.6 416.9 424.5 432.5 440.5 447.1</span></span>
<span><span class="co">## Durable goods 58.7 65.0 64.6 63.5 65.4 66.4 66.6</span></span>
<span><span class="co">## Nondurable goods 177.5 188.8 182.8 187.9 190.5 194.0 197.6</span></span>
<span><span class="co">## Services 162.6 174.9 169.5 173,1 176.7 180.1 182.9</span></span>
<span><span class="co">## Gross private domestic investment 92.9 104.9 103.4 102.8 106.2 107.0 109.1</span></span>
<span><span class="co">## Residential construction 27.5 27.7 27.7 28.0 27.7 27.3 27.5</span></span>
<span><span class="co">## Business fixed investment 60.5 69.8 66.9 68.4 70.9 73.1 75.1</span></span>
<span><span class="co">## Change in business inventories 4.8 7.4 8.8 6.4 7.6 6.6 6.5</span></span>
<span><span class="co">## Nonfarm 5.4 7.1 9.2 6.6 7.0 5.4 5.5</span></span>
<span><span class="co">## Net exports 8.6 7.3 6.0 8.0 7.4 7.8 8.1</span></span>
<span><span class="co">## Gov. purchases of goods &amp; services 128.4 135,0 131.3 133.5 135.4 139.7 142.7</span></span>
<span><span class="co">## Federal 65.3 66.6 64.9 65.7 66.5 69.4 70.7</span></span>
<span><span class="co">## Defense 49.9 49.9 48.8 49.2 49.8 51.8 52.7</span></span>
<span><span class="co">## Other 15.4 16.7 16.1 16.5 16.7 17.6 18.0</span></span>
<span><span class="co">## State and local 63.1 68,4 66.4 67.8 68.9 70.3 72.0</span></span>
<span><span class="co">## Gross National Product in Constant 577.6 609.3 597.7 603.5 613.0 622.4 630.1</span></span>
<span><span class="co">## (1958) Dollars</span></span>
<span><span class="co">## Personal income 495.0 530.5 516.2 524.7 536.0 544.9 552.0</span></span>
<span><span class="co">## Wages and salaries 333.5 357.3 348.9 353.6 359.0 367.5 374.1</span></span>
<span><span class="co">## Farm income 12.0 14.2 12.0 14.5 15.0 15.3 15.3</span></span>
<span><span class="co">## Personal contributions for</span></span>
<span><span class="co">## social insurance (deduction) 12.4 13.2 12.9 13.0 13.3 13.6 16.6</span></span>
<span><span class="co">## Disposable personal income 435.8 465.0 451.4 458.5 471.2 478.7 485.1</span></span>
<span><span class="co">## Personal saving 26.3 24.6 23.3 22.4 26.8 26.0 25.5</span></span>
<span><span class="co">## Saving rate (per cent) 6.0 5.3 5.2 4.9 5.7 5.4 5.3</span></span>
<span><span class="co">## Total labor force (millions) 77.0 78.3 77.7. 78.2 78.5 78.9 79.6</span></span>
<span><span class="co">## Armed forces " 2.7 2.7 2.7 2.7 2.7 2.8 2.9</span></span>
<span><span class="co">## Civilian labor force " 74.2 75.6 75.0 75.5 75.8 76,1 76,7</span></span>
<span><span class="co">## Employed " 70.4 72.1 71.3 71.9 72.4 72.9 73.6</span></span>
<span><span class="co">## Unemployed " 3.9 3.5 3.6 3.6 3.4 3.2 3.1</span></span>
<span><span class="co">## Unemployment rate (per cent) 5.2 4.6 4.8 4.7 4.4 4.2 4.0</span></span></code></pre>
<p>One way to organize the output is to split the text before the first digit on each line.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">text</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">text</span>, <span class="st">"\n"</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">text</span> <span class="op">&lt;-</span> <span class="va">text</span><span class="op">[</span><span class="fl">6</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">text</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">text</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">firstdigit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">regexpr</a></span><span class="op">(</span><span class="st">"[0-9]"</span>, <span class="va">text</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span>  <span class="va">variable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/trimws.html" class="external-link">trimws</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="va">text</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="fl">1</span>, <span class="va">firstdigit</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="va">text</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">firstdigit</span>, <span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">text</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, <span class="st">" "</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/trimws.html" class="external-link">trimws</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">","</span>, <span class="st">"."</span>, <span class="va">values</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"\\.$"</span>, <span class="st">""</span>, <span class="va">values</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">values</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">next</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">variable</span>, <span class="va">values</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"variable"</span>, <span class="st">"y1964"</span>, <span class="st">"y1965est"</span>, <span class="st">"y1965q1"</span>,</span>
<span>    <span class="st">"y1965q2"</span>, <span class="st">"y1965q3"</span>, <span class="st">"y1965q4est"</span>, <span class="st">"y1966q1pro"</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">i</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                            variable y1964 y1965est y1965q1 y1965q2 y1965q3</span></span>
<span><span class="co">## 1            Gross National Product 628.7    675.7   657.6   668.8   681.5</span></span>
<span><span class="co">## 2 Personal consumption expenditures 398.9    428.6   416.9   424.5   432.5</span></span>
<span><span class="co">## 3                     Durable goods  58.7       65    64.6    63.5    65.4</span></span>
<span><span class="co">## 4                  Nondurable goods 177.5    188.8   182.8   187.9   190.5</span></span>
<span><span class="co">## 5                          Services 162.6    174.9   169.5   173.1   176.7</span></span>
<span><span class="co">## 6 Gross private domestic investment  92.9    104.9   103.4   102.8   106.2</span></span>
<span><span class="co">##   y1965q4est y1966q1pro</span></span>
<span><span class="co">## 1        695        707</span></span>
<span><span class="co">## 2      440.5      447.1</span></span>
<span><span class="co">## 3       66.4       66.6</span></span>
<span><span class="co">## 4        194      197.6</span></span>
<span><span class="co">## 5      180.1      182.9</span></span>
<span><span class="co">## 6        107      109.1</span></span></code></pre>
<p>The result is not perfect (e.g. I still need to change “Gross National Product in Constant” to add the “(1958) Dollars”), but neither is Textract’s and it requires to write a more complex loop to organize the data. Certainly, this can be simplified by using the Tidyverse.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jeroen Ooms, Mauricio Vargas Sepulveda, Munk School of Global Affairs and Public Policy.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
